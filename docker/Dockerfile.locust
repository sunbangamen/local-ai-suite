FROM python:3.12-slim

WORKDIR /app

# Install Locust and dependencies
RUN pip install --no-cache-dir \
    locust==2.20.0 \
    gevent-websocket

# Copy the locustfile
COPY tests/load/locustfile.py /app/locustfile.py

# Expose Locust web UI port
EXPOSE 8089

# Default command - can be overridden
ENTRYPOINT ["locust"]
CMD ["-f", "locustfile.py", "--host", "http://api-gateway:8000", "--headless"]
