# ========== Service Ports ==========
HOST=0.0.0.0
API_GATEWAY_PORT=8000
INFERENCE_PORT=8001
RAG_PORT=8002
EMBEDDING_PORT=8003
MCP_PORT=8020

# ========== Model Configuration ==========
# Phase 2: 3B Chat + 7B Code (RTX 4050 6GB optimized)
CHAT_MODEL=Qwen2.5-3B-Instruct-Q4_K_M.gguf
CODE_MODEL=qwen2.5-coder-7b-instruct-q4_k_m.gguf

# Phase 3: 7B Chat + 7B Code (recommended 8GB+ VRAM)
# CHAT_MODEL=Qwen2.5-7B-Instruct-Q4_K_M.gguf
# CODE_MODEL=qwen2.5-coder-7b-instruct-q4_k_m.gguf

# Model paths
MODELS_DIR=/mnt/e/ai-models
DATA_DIR=/mnt/e/ai-data

# ========== RAG Configuration ==========
QDRANT_URL=http://qdrant:6333
EMBEDDING_URL=http://embedding:8003
EMBEDDING_MODEL=BAAI/bge-small-en-v1.5

# RAG LLM Settings
RAG_LLM_TIMEOUT=120
RAG_LLM_MAX_TOKENS=256
RAG_LLM_TEMPERATURE=0.3

# RAG Search & Indexing
RAG_TOPK=4
RAG_CHUNK_SIZE=512
RAG_CHUNK_OVERLAP=100

# API Gateway Model Names (for RAG service)
API_GATEWAY_CHAT_MODEL=chat-7b
API_GATEWAY_CODE_MODEL=code-7b
API_GATEWAY_URL=http://api-gateway:8000

# ========== Timeout Configuration ==========
# LLM Request Timeouts
LLM_REQUEST_TIMEOUT=60           # General LLM API call timeout (seconds)
LLM_CONNECT_TIMEOUT=10           # LLM connection timeout (seconds)

# Service-specific Timeouts
QDRANT_TIMEOUT=30                # Qdrant query timeout (seconds)
EMBEDDING_TIMEOUT=30             # Embedding generation timeout (seconds)

# ========== Retry Configuration ==========
# Qdrant Retry Settings (for RAG service)
QDRANT_MAX_RETRIES=3             # Number of retry attempts
QDRANT_RETRY_MIN_WAIT=2          # Minimum wait time between retries (seconds)
QDRANT_RETRY_MAX_WAIT=10         # Maximum wait time between retries (seconds)

# ========== Llama.cpp Parameters ==========
# GPU Layer Configuration (Phase 2 specific)
CHAT_N_GPU_LAYERS=999            # Chat model: all layers on GPU (3B model)
CODE_N_GPU_LAYERS=20             # Code model: partial GPU, rest on CPU (7B model)

# General Llama.cpp Settings
LLAMA_N_GPU_LAYERS=999           # GPU layers (999=auto-max, for Phase 1/3)
LLAMA_PARALLEL=1                 # Parallel requests
LLAMA_TEMP=0.3                   # Temperature
LLAMA_TOP_P=0.9                  # Top-p sampling
LLAMA_REPEAT_PENALTY=1.05        # Repeat penalty

# ========== Security & RBAC (Issue #8) ==========
RBAC_ENABLED=false
SECURITY_DB_PATH=/mnt/e/ai-data/sqlite/security.db
SECURITY_QUEUE_SIZE=1000
SECURITY_LOG_LEVEL=INFO
SECURITY_MODE=normal
SANDBOX_ENABLED=true
RATE_LIMIT_ENABLED=true

# ========== Approval Workflow (Issues #16, #26, #40) ==========
# 승인 워크플로우 설정 (HIGH/CRITICAL 보안 레벨 도구 실행 시 관리자 승인 필요)
# 문서: docs/security/APPROVAL_GUIDE.md, docs/security/OPERATIONS_GUIDE.md

APPROVAL_WORKFLOW_ENABLED=false          # 승인 워크플로우 활성화 여부 (기본값: false)
                                         # 프로덕션: true (권장), 개발: false
                                         # 변경 후 반드시 `docker compose restart mcp-server` 실행

APPROVAL_TIMEOUT=300                     # 승인 요청 타임아웃 (초 단위, 기본값: 300 = 5분)
                                         # 낮은 값: 빠른 응답 요구, 높은 값: 관리자 여유 시간
                                         # 권장값: 300-600초 (5-10분)
                                         # 운영팀이 자주 부재 중인 경우: 600-900초

APPROVAL_POLLING_INTERVAL=1              # 승인 상태 폴링 간격 (초 단위, 기본값: 1)
                                         # CLI가 승인 완료를 체크하는 주기
                                         # 권장값: 1초 (변경 권장하지 않음, 시스템 부하↑)

APPROVAL_MAX_PENDING=50                  # 동시 대기 승인 요청 최대 개수 (기본값: 50)
                                         # 초과 시 새 요청은 즉시 실패 (403 Forbidden)
                                         # 권장값: 50-100 (동시 사용자 수에 따라 조정)

# ========== Email Notifications (Phase 6.4) ==========
# Email 기반 승인 알림 설정
# 문서: docs/ops/NOTIFICATION_GUIDE.md

NOTIFICATION_ENABLED=false               # Email 알림 활성화 여부 (기본값: false)

# SMTP 서버 설정
SMTP_HOST=localhost                      # SMTP 서버 주소 (기본값: localhost)
                                         # 로컬 테스트: localhost 또는 mailhog
                                         # 프로덕션: smtp.gmail.com, smtp.office365.com 등
SMTP_PORT=587                            # SMTP 포트 (기본값: 587 = STARTTLS)
                                         # 일반: 587 (STARTTLS), 465 (SSL/TLS)
SMTP_USE_TLS=true                        # TLS 사용 여부 (기본값: true)
SMTP_USER=                               # SMTP 사용자 (필수 - 빈 경우 인증 없음)
SMTP_PASSWORD=                           # SMTP 비밀번호 (필수 - 빈 경우 인증 없음)

# Email 주소
EMAIL_FROM=admin@localhost               # 발송자 Email (기본값: admin@localhost)
EMAIL_TO=operator@localhost              # 수신자 Email (기본값: operator@localhost)
                                         # 쉼표로 구분하여 여러 수신자 지정 가능 (향후)

# 알림 배치 처리 설정
NOTIFICATION_BATCH_SIZE=10               # 배치 처리 아이템 수 (기본값: 10)
                                         # 작은 값: 빠른 발송, 큰 값: 효율적 처리
NOTIFICATION_BATCH_TIMEOUT=5             # 배치 타임아웃 (초 단위, 기본값: 5)
                                         # 큐가 비어있으면 이 시간 후 배치 처리

# 로컬 테스트용 MailHog 설정 (Docker Compose)
# SMTP_HOST=mailhog
# SMTP_PORT=1025
# EMAIL_FROM=test@localhost
# EMAIL_TO=admin@localhost
# NOTIFICATION_ENABLED=true
