============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0 -- /usr/local/bin/python3.11
cachedir: .pytest_cache
rootdir: /app
plugins: anyio-4.11.0, asyncio-1.2.0, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 18 items

tests/test_embedding.py::test_embed_single_text PASSED                   [  5%]
tests/test_embedding.py::test_embed_batch_texts PASSED                   [ 11%]
tests/test_embedding.py::test_health_shows_model_info PASSED             [ 16%]
tests/test_embedding.py::test_exceed_max_texts_truncates PASSED          [ 22%]
tests/test_embedding.py::test_exceed_max_chars_truncates PASSED          [ 27%]
tests/test_embedding.py::test_empty_texts_list_returns_empty PASSED      [ 33%]
tests/test_embedding.py::test_reload_model_successfully PASSED           [ 38%]
tests/test_embedding.py::test_batch_embedding_concurrent_processing PASSED [ 44%]
tests/test_embedding.py::test_embedding_model_error_handling PASSED      [ 50%]
tests/test_embedding.py::test_embedding_invalid_input_types PASSED       [ 55%]
tests/test_embedding.py::test_reload_model_with_new_model PASSED         [ 61%]
tests/test_embedding.py::test_reload_model_failure PASSED                [ 66%]
tests/test_embedding.py::test_embed_with_whitespace_texts PASSED         [ 72%]
tests/test_embedding.py::test_batch_size_extreme_cases PASSED            [ 77%]
tests/test_embedding.py::test_model_dimension_consistency PASSED         [ 83%]
tests/test_embedding.py::test_startup_model_loading_path PASSED          [ 88%]
tests/test_embedding.py::test_load_model_with_cache_and_threads PASSED   [ 94%]
tests/test_embedding.py::test_health_endpoint_model_failure PASSED       [100%]

=============================== warnings summary ===============================
app.py:82
  /app/app.py:82: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("startup")

../usr/local/lib/python3.11/site-packages/fastapi/applications.py:4574
  /usr/local/lib/python3.11/site-packages/fastapi/applications.py:4574: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    return self.router.on_event(event_type)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.13-final-0 _______________

Name                      Stmts   Miss  Cover   Missing
-------------------------------------------------------
app.py                       88     17    81%   53-58, 65-68, 85-89, 165-166, 170-172
tests/test_embedding.py     229      2    99%   225, 291
-------------------------------------------------------
TOTAL                       317     19    94%
Coverage JSON written to file coverage.json
======================== 18 passed, 2 warnings in 0.94s ========================
