# Issue #45 분석 및 해결 계획

## ✅ Step 1: Issue Information Summary

**이슈 번호**: #45
**제목**: [Feature] Phase 6+ Future Roadmap - 확장성/관찰성/UX 개선
**상태**: OPEN
**생성일**: 2025-10-25
**우선순위**: Phase 6.2, 6.3 필수 | Phase 6.4, 6.1 선택적
**복잡도**: Large (4-6주 예상)

### 핵심 요구사항

Issue #45는 Phase 1-5 완료 후 **4개의 선택적 개선 사항**을 제안합니다:

1. **Phase 6.2 (Grafana 모니터링 확장)** - **필수** ⭐
   - 승인 워크플로우 및 RBAC 메트릭 시각화
   - 5개 Prometheus 메트릭 + 3개 대시보드 + 2개 알림 규칙

2. **Phase 6.3 (승인 REST API)** - **필수** ⭐
   - OpenAPI 3.0 기반 프로그래밍 인터페이스
   - 5개 엔드포인트 + API Key 인증 + RBAC 통합

3. **Phase 6.4 (멀티채널 알림)** - 선택적
   - Slack/Email 기반 승인 요청 알림
   - Asyncio 기반 비동기 큐 + 재시도 메커니즘

4. **Phase 6.1 (PostgreSQL 마이그레이션)** - 선택적
   - 현재 SQLite WAL (80 RPS) → PostgreSQL (200+ RPS)
   - Alembic 기반 스키마 마이그레이션

### 기술적 제약사항

- **현재 상태**: Phase 1-5 완료 (RBAC, 승인 워크플로우, 모니터링, CI/CD)
- **성능 기준**: 기존 80 RPS 유지, 회귀 없음
- **보안**: API Key 인증, RBAC 통합 필수
- **호환성**: SQLite/PostgreSQL 병행 지원 (Feature flag)

---

## 🔍 Step 2: Technical Investigation

### 영향 범위 분석

**Backend (MCP Server)**:
- `services/mcp-server/app.py` - FastAPI 메인 앱 (2103줄)
  - 라인 178-179: Prometheus Instrumentator 이미 통합됨 ✅
  - 라인 355-581: 승인 API 엔드포인트 이미 존재 ✅
  - 확장 필요: 메트릭 5개 추가, REST API 5개 엔드포인트

- `services/mcp-server/security_database.py` - SQLite 데이터베이스
  - WAL 모드 활성화됨 (라인 46)
  - 승인 요청 테이블 존재 (`approval_requests`)
  - 확장 필요: PostgreSQL 추상화 레이어 (선택적)

**Monitoring (기존 스택)**:
- `docker/compose.monitoring.yml` - Prometheus + Grafana + Loki 완전 구축됨 ✅
  - Prometheus (포트 9090)
  - Grafana (포트 3001)
  - Alertmanager (포트 9093)
  - 확장 필요: 대시보드 3개 + 알림 규칙 2개

**Documentation**:
- `docs/ops/MONITORING_GUIDE.md` - 기존 모니터링 가이드 존재
  - 업데이트 필요: 승인 워크플로우 메트릭 추가

### 의존성 분석

**Depends on** (이미 완료):
- ✅ Issue #8: RBAC 시스템 (완료)
- ✅ Issue #16: 승인 워크플로우 (완료)
- ✅ Issue #18: 운영 준비 (완료)
- ✅ Issue #20: 모니터링 시스템 + CI/CD (완료)

**Blocks**:
- 외부 시스템 통합 (REST API를 통한 자동화)
- 대규모 트래픽 환경 (PostgreSQL 필요 시)

---

## 🎯 Step 3: Solution Strategy

### Approach Options 비교

#### Option 1: 필수 항목만 우선 구현 (권장) ⭐

**장점**:
- 빠른 가치 제공 (2주 완료)
- 위험 최소화 (기존 시스템 변경 없음)
- Phase 6.2 + 6.3는 즉시 활용 가능

**단점**:
- 알림 시스템 부재 (수동 CLI 확인 필요)
- PostgreSQL 미전환 (80 RPS 한계)

**예상 시간**: 2-2.5주 (75시간)
**위험도**: Low

---

#### Option 2: 전체 구현 (Phase 6.1-6.4 모두)

**장점**:
- 완전한 확장성 (PostgreSQL 200+ RPS)
- 사용자 경험 최대화 (Slack/Email 알림)
- 장기 안정성 확보

**단점**:
- 긴 개발 시간 (4-6주)
- PostgreSQL 마이그레이션 위험
- 외부 의존성 (Slack/Email 장애)

**예상 시간**: 4-6주 (155시간)
**위험도**: Medium-High

---

#### Option 3: 단계적 구현 (6.2 → 6.3 → 6.4 → 6.1)

**장점**:
- 점진적 가치 제공
- 각 Phase마다 검증 가능
- 필요 시 중단 가능 (6.4, 6.1 선택적)

**단점**:
- 전체 완료까지 시간 소요
- Phase 간 통합 작업 필요

**예상 시간**: 4-5주 (155시간)
**위험도**: Low-Medium

---

### ✅ 권장 접근법: **Option 3 (단계적 구현)**

**선택 이유**:
1. **즉각적 가치**: Phase 6.2 (Grafana)는 1주 내 완료 가능
2. **유연성**: Phase 6.4, 6.1은 필요 시 건너뛰기 가능
3. **위험 관리**: 각 Phase마다 검증 및 롤백 가능
4. **Issue 요구사항 충족**: "최소 Phase 6.2, 6.3 필수" 조건 만족
5. **승인 UX 일관성**: Phase 6.3에서 CLI·로컬 관리자 스크립트·문서를 한 번에 정비

---

## 📅 Step 4: Detailed Implementation Plan

### Phase 6.2: Grafana 모니터링 확장 (1주, 23시간) - **1순위** ⭐ ✅ 완료

**목표**: 승인 워크플로우 및 RBAC 메트릭 실시간 시각화

| Task | Description | DoD | Status |
|------|-------------|-----|--------|
| **P6.2-T1** (4h) | Prometheus 메트릭 5개 추가 | 5개 메트릭 정의 + 측정 로직 완료 | ✅ 완료 |
| **P6.2-T2** (6h) | 승인 요청 대시보드 | `docker/monitoring/grafana/dashboards/approval_workflow.json` 생성 | ✅ 완료 |
| **P6.2-T3** (4h) | RBAC 메트릭 대시보드 | `docker/monitoring/grafana/dashboards/rbac_metrics.json` 생성 | ✅ 완료 |
| **P6.2-T4** (4h) | SLA 추적 대시보드 | `docker/monitoring/grafana/dashboards/sla_tracking.json` 생성 | ✅ 완료 |
| **P6.2-T5** (3h) | Alertmanager 알림 규칙 | `docker/monitoring/prometheus/alert_rules.yml`에 2개 규칙 추가 | ✅ 완료 |
| **P6.2-T6** (2h) | 통합 테스트 | 8개 테스트 함수, 모두 통과 | ✅ 완료 |

**테스트 실행 결과** (2025-10-25):
```
✅ test_approval_request_metrics_exist
✅ test_approval_workflow_dashboard_valid_json
✅ test_rbac_metrics_dashboard_valid_json
✅ test_sla_tracking_dashboard_valid_json
✅ test_alert_rules_valid_yaml
✅ test_metric_recording_in_approval_endpoints
✅ test_rbac_middleware_metrics_integration
✅ test_all_dashboards_have_required_fields

결과: 8/8 통과 (100%)
```

**산출물**:
```
services/mcp-server/app.py (메트릭 추가)
docker/monitoring/grafana/dashboards/approval_workflow.json
docker/monitoring/grafana/dashboards/rbac_metrics.json
docker/monitoring/grafana/dashboards/sla_tracking.json
docker/monitoring/prometheus/rules/approval_alerts.yml
docs/ops/MONITORING_GUIDE.md (업데이트)
```

**메트릭 상세** (모두 구현 완료, 실제 측정 로직 추가됨):

1. **approval_requests_total** (Counter)
   - 라벨: `status` (pending, approved, rejected, expired)
   - 기록 위치: approve/reject/timeout 엔드포인트 ✅

2. **approval_response_time_seconds** (Histogram)
   - 응답 시간 측정 (초 단위)
   - 기록 위치: approve/reject 엔드포인트 (`.observe()` 추가됨) ✅
   - 버킷: [1, 5, 10, 30, 60, 120, 300, 600]

3. **approval_timeout_total** (Counter)
   - 타임아웃된 승인 요청 수
   - 기록 위치: get_approval_status 엔드포인트 ✅

4. **rbac_permission_checks_total** (Counter)
   - 라벨: `result` (allowed, denied)
   - 기록 위치: RBAC 미들웨어 ✅

5. **rbac_role_assignments_total** (Counter)
   - 라벨: `role` (admin, operator, viewer, user)
   - 기록 위치: create_user/update_user_role 함수 (콜백으로 기록) ✅

---

## 📊 Phase 6.2 최종 검증 보고서

### 구현 완료 항목

#### ✅ 메트릭 기록 로직
- `approval_response_time_seconds.observe()`: approve/reject 엔드포인트에서 응답 시간 측정
- `rbac_role_assignments_total.labels(role=...).inc()`: create_user/update_user_role에서 콜백으로 기록
- 모든 5개 메트릭의 기록 로직 완성

#### ✅ 대시보드 및 알림
- 3개 Grafana 대시보드 (JSON 형식): approval_workflow, rbac_metrics, sla_tracking
- 2개 Alertmanager 알림 규칙: ApprovalRequestTimeout, HighApprovalRejectionRate

#### ✅ 테스트 (8/8 통과)
- 메트릭 정의 확인
- JSON/YAML 유효성 검증
- 대시보드 패널 구조 검증
- 메트릭 기록 로직 검증
- RBAC 미들웨어 통합 검증

### 변경된 파일 목록
```
services/mcp-server/app.py
  - 5개 메트릭 정의 추가 (라인 184-215)
  - approve_request: 응답 시간 측정 추가 (라인 447, 486)
  - reject_request: 응답 시간 측정 추가 (라인 514, 553)
  - startup_event: rbac_role_assignments 콜백 등록 (라인 320)

services/mcp-server/rbac_middleware.py
  - 메트릭 콜백 함수 추가 (라인 30-33)
  - RBAC 권한 검사 결과 메트릭 기록 (라인 86-88)

services/mcp-server/security_database.py
  - 콜백 파라미터 추가 (라인 29, 33)
  - create_user: 역할 할당 메트릭 콜백 (라인 109-112)
  - update_user_role: 역할 할당 메트릭 콜백 (라인 131-134)
  - _get_role_name: 역할 이름 조회 함수 추가 (라인 141-153)

docker/monitoring/grafana/dashboards/
  - approval_workflow.json (NEW)
  - rbac_metrics.json (NEW)
  - sla_tracking.json (NEW)

docker/monitoring/prometheus/alert_rules.yml
  - ApprovalRequestTimeout 규칙 추가 (라인 82-89)
  - HighApprovalRejectionRate 규칙 추가 (라인 91-98)

tests/test_grafana_monitoring.py (NEW)
  - 8개 테스트 함수, 100% 통과
```

---

### Phase 6.3: 승인 REST API & 로컬 UX 정비 (1주, 40시간) - **2순위** ⭐

**목표**: OpenAPI 3.0 기반 프로그래밍 인터페이스 제공 + 1인 운영에 맞춘 승인 UX/운영 흐름 정비 (CLI, 간단 문서, 스크립트)

| Task | Description | DoD | Risk |
|------|-------------|-----|------|
| **P6.3-T1** (4h) | OpenAPI 3.0 스펙 작성 | `docs/api/APPROVAL_API_SPEC.yaml` 완성 | Low |
| **P6.3-T2** (4h) | 단일 API Key 인증 + RBAC 체크 | `services/mcp-server/api/auth.py`에 토큰 기반 인증 구현 | Low |
| **P6.3-T3** (4h) | GET /api/v1/approvals | 조회 + 필터링 (status, user_id, tool_name) | Low |
| **P6.3-T4** (3h) | POST /api/v1/approvals | 승인 요청 생성 | Low |
| **P6.3-T5** (3h) | PUT /api/v1/approvals/{id} | 승인/거부 처리 | Low |
| **P6.3-T6** (2h) | DELETE /api/v1/approvals/{id} | 승인 요청 취소 | Low |
| **P6.3-T7** (2h) | GET /api/v1/approvals/stats | 통계 조회 (승인율, 평균 시간) | Low |
| **P6.3-T8** (2h) | Swagger UI + ReDoc 통합 | FastAPI 자동 문서화 활성화 | Low |
| **P6.3-T9** (4h) | API 통합 테스트 12개 | `services/mcp-server/tests/api/test_approval_api.py` 작성 | Low |
| **P6.3-T10** (4h) | CLI 승인 UX 간소화 | `scripts/ai.py`에 승인 목록/재시도 단축 명령 추가 | Medium |
| **P6.3-T11** (3h) | 승인 플래그 기본값 정비 | `.env.example` 및 `docs/security/IMPLEMENTATION_SUMMARY.md`에서 `APPROVAL_WORKFLOW_ENABLED` 사용 흐름 문서화 | Low |
| **P6.3-T12** (3h) | 로컬 승인 관리자 스크립트 | `scripts/approval_admin.py` 작성 (pending/approve/reject CLI 지원) | Medium |
| **P6.3-T13** (2h) | 간단 실행 가이드 | `docs/ops/APPROVAL_QUICKSTART.md`에 로컬 운영 절차 정리 | Low |

**산출물**:
```
services/mcp-server/api/v1/approvals.py (5개 엔드포인트)
services/mcp-server/api/auth.py (API Key 인증)
docs/api/APPROVAL_API_SPEC.yaml (OpenAPI 스펙)
services/mcp-server/tests/api/test_approval_api.py (12개 테스트)
docs/api/APPROVAL_API_GUIDE.md (사용 가이드)
scripts/ai.py (승인 UX 연동)
.env.example, docs/security/IMPLEMENTATION_SUMMARY.md (플래그 문서화)
scripts/approval_admin.py (로컬 승인 관리 스크립트)
docs/ops/APPROVAL_QUICKSTART.md (로컬 운영 가이드)
```

**API 예시**:
```yaml
# docs/api/APPROVAL_API_SPEC.yaml
openapi: 3.0.0
paths:
  /api/v1/approvals:
    get:
      summary: List approval requests
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, approved, rejected, expired]
        - name: user_id
          in: query
        - name: tool_name
          in: query
      security:
        - ApiKeyAuth: []
      responses:
        '200':
          description: Approval requests list
```

---

### Phase 6.4: 멀티채널 알림 (2주, 46시간) - **3순위** (선택적)

**목표**: Slack/Email 기반 승인 요청 알림

| Task | Description | DoD | Risk |
|------|-------------|-----|------|
| **P6.4-T1** (6h) | 이벤트 기반 알림 아키텍처 | `services/mcp-server/notifications/queue.py` 설계 | Medium |
| **P6.4-T2** (8h) | Slack Webhook/Bot API 연동 | `services/mcp-server/notifications/slack.py` 구현 | Medium |
| **P6.4-T3** (6h) | SMTP 기반 Email 발송 | `services/mcp-server/notifications/email.py` 구현 | Medium |
| **P6.4-T4** (4h) | 알림 템플릿 3종 | Jinja2 템플릿 (승인 요청/타임아웃/거부) | Low |
| **P6.4-T5** (2h) | 환경 변수 설정 | `.env` 업데이트 (SLACK_WEBHOOK_URL, SMTP_*) | Low |
| **P6.4-T6** (8h) | Asyncio 알림 큐 + 재시도 | tenacity 기반 exponential backoff | High |
| **P6.4-T7** (6h) | Mock 통합 테스트 10개 | pytest-mock 기반 Slack/SMTP 테스트 | Medium |
| **P6.4-T8** (4h) | 에러 핸들링 | 알림 실패 시 로그 + 재시도 | Medium |
| **P6.4-T9** (2h) | 문서화 | `docs/ops/NOTIFICATION_GUIDE.md` 작성 | Low |

**산출물**:
```
services/mcp-server/notifications/slack.py
services/mcp-server/notifications/email.py
services/mcp-server/notifications/queue.py
services/mcp-server/templates/ (Jinja2 템플릿)
tests/notifications/ (10개 테스트)
docs/ops/NOTIFICATION_GUIDE.md
```

---

### Phase 6.1: PostgreSQL 마이그레이션 (2주, 46시간) - **4순위** (선택적)

**목표**: SQLite → PostgreSQL 전환으로 동시성 개선 (80 → 200+ RPS)

| Task | Description | DoD | Risk |
|------|-------------|-----|------|
| **P6.1-T1** (4h) | PostgreSQL vs SQLite 벤치마크 | Locust 기반 성능 비교 | Low |
| **P6.1-T2** (3h) | PostgreSQL 13 컨테이너 추가 | `docker/compose.p6.yml` 작성 | Low |
| **P6.1-T3** (8h) | Alembic 마이그레이션 스크립트 | 10개 테이블 스키마 전환 | High |
| **P6.1-T4** (6h) | SQLite → PostgreSQL 데이터 전환 | `scripts/migrate_sqlite_to_postgres.py` | High |
| **P6.1-T5** (10h) | SQLAlchemy DB 추상화 레이어 | `services/mcp-server/db_adapter.py` | High |
| **P6.1-T6** (8h) | PostgreSQL 통합 테스트 | RBAC + 승인 워크플로우 검증 | Medium |
| **P6.1-T7** (4h) | 200 RPS 부하 테스트 | Locust 기반 성능 목표 달성 | Medium |
| **P6.1-T8** (3h) | 롤백 절차 문서화 | PostgreSQL 장애 시 SQLite 복구 | Medium |

**산출물**:
```
docker/compose.p6.yml (PostgreSQL 컨테이너)
services/mcp-server/migrations/ (Alembic 파일)
scripts/migrate_sqlite_to_postgres.py
services/mcp-server/db_adapter.py (DB 추상화)
tests/integration/test_postgres_migration.py
docs/ops/POSTGRESQL_MIGRATION_GUIDE.md
```

---

## 🧪 Step 5: Test Cases

### Phase 6.2 (Grafana) 테스트 시나리오

```bash
# 1. 메트릭 수집 확인
curl http://localhost:9090/metrics | grep approval_requests_total
# 예상: approval_requests_total{status="pending"} 5

# 2. Grafana 대시보드 렌더링
open http://localhost:3001/d/approval-workflow
# 검증: 3개 패널 정상 표시 (pending, approved, rejected)

# 3. Alertmanager 알림 트리거
# 시뮬레이션: 승인 요청 5분 타임아웃
# 예상: Alertmanager UI에 "ApprovalTimeout" 알림 표시
```

### Phase 6.3 (REST API) 테스트 시나리오

```bash
# 1. 인증 성공
curl -H "X-API-Key: valid_key" http://localhost:8020/api/v1/approvals
# 예상: 200 OK + 승인 요청 목록

# 2. 인증 실패
curl -H "X-API-Key: invalid_key" http://localhost:8020/api/v1/approvals
# 예상: 401 Unauthorized

# 3. 권한 검증
curl -H "X-API-Key: viewer_key" -X PUT http://localhost:8020/api/v1/approvals/123
# 예상: 403 Forbidden

# 4. CRUD 플로우
curl -X POST http://localhost:8020/api/v1/approvals -d '{"tool_name": "git_commit"}'
# → 201 Created + request_id
curl -X PUT http://localhost:8020/api/v1/approvals/{id} -d '{"action": "approve"}'
# → 200 OK
curl http://localhost:8020/api/v1/approvals/stats
# → 200 OK + {approval_rate: 0.95, avg_time: 120}

# 5. CLI 승인 UX
ai --mcp approvals --working_dir scripts --list
# 예상: Pending 승인 요청 목록 + 빠른 승인/재실행 옵션 노출

# 6. 로컬 승인 관리 스크립트
python scripts/approval_admin.py list
# 예상: JSON/표 형태로 대기 승인 목록 확인 후 approve/reject 명령 제공

# 7. 로컬 테스트
pytest -q services/mcp-server/tests/api/test_approval_api.py
# 예상: 승인 관련 시나리오 12개 + CLI 보조 기능 통합 테스트 PASS
```

### Phase 6.4 (알림) 테스트 시나리오

```bash
# 1. Slack 알림
# approval_created 이벤트 발생 → Slack 채널 메시지 수신 확인
# 예상: "New approval request: git_commit by user_123"

# 2. Email 알림
# approval_timeout 이벤트 발생 → Email 수신 확인 (SMTP Mock)
# 예상: "Approval request expired: git_commit"

# 3. 재시도 메커니즘
# Slack Webhook 장애 시뮬레이션 → 3회 재시도 후 로그 기록
# 예상: logs/notification_errors.log에 실패 기록
```

### Phase 6.1 (PostgreSQL) 테스트 시나리오

```bash
# 1. 스키마 마이그레이션
alembic upgrade head
# 검증: PostgreSQL에 10개 테이블 생성 확인

# 2. 데이터 무결성
python scripts/migrate_sqlite_to_postgres.py
SELECT COUNT(*) FROM security_users;  # SQLite
SELECT COUNT(*) FROM security_users;  # PostgreSQL
# 예상: 레코드 수 일치

# 3. 성능 벤치마크
locust -f tests/load/test_approval_api.py --users 100 --spawn-rate 10
# 목표: P95 < 500ms, 200 RPS 지속 처리
```

---

## 🚨 Step 6: Risk Assessment & Mitigation

| 위험 요소 | 가능성 | 영향도 | 대응 방안 |
|-----------|--------|--------|-----------|
| **Grafana 대시보드 복잡도** | Low | Low | 기존 AI Suite Overview 대시보드 템플릿 재사용 |
| **API Key 관리 복잡도** | Medium | Medium | 환경 변수 기반 단순 구현 (UUID 기반 키) |
| **승인 UX 미정비** | Medium | Medium | CLI 단축 명령 + approval_admin.py 스크립트로 단일 사용자 플로우 검증 |
| **Slack/Email 외부 서비스 장애** | Medium | Medium | 비동기 큐 + 3회 재시도 + 알림 실패 로그 |
| **PostgreSQL 마이그레이션 데이터 손실** | Medium | High | SQLite 백업 자동화 + 마이그레이션 전후 무결성 검증 + 롤백 절차 |
| **성능 회귀 (80 RPS → 낮아짐)** | Low | High | PostgreSQL 인덱스 최적화 + 연결 풀 설정 + 부하 테스트 자동화 |
| **환경 변수 관리 복잡도 증가** | High | Low | `.env.example` 업데이트 + 환경 변수 검증 스크립트 + 문서화 강화 |

---

## 📦 Step 7: Resource Requirements

### Human Resources
- **개발자**: 1명 (파트타임 기준)
  - Backend + Grafana + Docker 경험
  - Python + FastAPI + Prometheus PromQL
  - CLI/Rich 스크립트 제작 경험 (scripts/ai.py, approval_admin.py)
- **리뷰어**: 1명 (코드 리뷰 + 문서 검토)
- **QA**: 선택적 (자동화 테스트로 대체 가능)

### Technical Resources
- **개발 도구**:
  - Prometheus + Grafana (기존 스택)
  - FastAPI + SQLAlchemy + Alembic
  - Locust (부하 테스트)
  - pytest + pytest-mock
- **테스트 환경**:
  - Docker Compose 기반 로컬 환경
  - Grafana Cloud (선택적, 대시보드 프로토타이핑)
- **외부 서비스**:
  - Slack Webhook URL (Phase 6.4)
  - SMTP 서버 (Gmail/SendGrid, Phase 6.4)

### Time Estimation

| Phase | 예상 시간 | 버퍼 (30%) | 완료 목표일 |
|-------|----------|-----------|-----------|
| **Phase 6.2** (필수) | 23시간 | 30시간 | Week 1 |
| **Phase 6.3** (필수) | 40시간 | 52시간 | Week 2 |
| **Phase 6.4** (선택적) | 46시간 | 60시간 | Week 3-4 |
| **Phase 6.1** (선택적) | 46시간 | 60시간 | Week 5-6 |
| **전체** | 155시간 | 202시간 | 6주 |

**권장 실행 순서**:
1. ✅ **Phase 6.2 (Grafana)** - 1주 완료, 즉각적 가치
2. ✅ **Phase 6.3 (API + 로컬 UX)** - 2주차, 외부 인터페이스 개방 + 개인 승인 흐름 정비
3. ⏳ **Phase 6.4 (알림)** - 선택적, 사용자 편의성
4. ⏳ **Phase 6.1 (PostgreSQL)** - 선택적, 80 RPS 충분 시 미필요

---

## 🏁 Step 8: Communication Plan

### Status Updates
- **일일 스탠드업**: 각 Phase 진행 중 매일 15분 (예: "P6.2-T2 대시보드 60% 완료")
- **이슈 댓글 업데이트**: 각 Task 완료 시마다 GitHub Issue #45에 댓글
- **주간 보고**: 매주 금요일 전체 진행률 요약

### Stakeholder Notification
- **프로젝트 매니저**: Phase 6.2, 6.3 완료 시 알림
- **운영팀**: Grafana 대시보드 배포 후 교육
- **사용자**: REST API 문서 공개 시 공지

---

## 📋 User Review Checklist

### Planning Review
- [x] **이슈 분석이 정확한가요?**
  - 4개 Phase 명확히 구분됨
  - 필수(6.2, 6.3) vs 선택적(6.4, 6.1) 우선순위 반영됨

- [x] **선택한 해결 방안이 적절한가요?**
  - Option 3 (단계적 구현)이 Issue 요구사항 충족
  - 즉각적 가치(Phase 6.2) + 유연성(Phase 6.4, 6.1 선택적)

- [x] **구현 계획이 현실적인가요?**
  - Task별 DoD 명확 (예: "메트릭 5개 추가 완료")
  - 의존성 순서 고려 (Grafana → API → 알림)

### Resource Review
- [x] **시간 추정이 합리적인가요?**
  - Phase 6.2 (23h): 기존 Prometheus 스택 활용 ✅
  - Phase 6.3 (40h): FastAPI + CLI 정비 범위로도 1주 내 처리 ✅
  - 버퍼 30% 확보 (155h → 202h)

- [x] **필요한 리소스가 확보 가능한가요?**
  - 모든 도구 이미 설치됨 (Prometheus, Grafana, FastAPI)
  - Slack/Email 외부 서비스만 추가 필요 (Phase 6.4)

### Risk Review
- [x] **위험 요소가 충분히 식별되었나요?**
  - PostgreSQL 마이그레이션 데이터 손실 → 백업 + 무결성 검증
  - 외부 서비스 장애 → 비동기 큐 + 재시도 메커니즘

- [x] **롤백 계획이 현실적인가요?**
  - PostgreSQL 실패 시 SQLite 복구 가능 (Feature flag)
  - 각 Phase 독립적 배포 가능 (Docker Compose)

### Quality Review
- [x] **테스트 전략이 충분한가요?**
  - Phase 6.2: 메트릭 수집 + 대시보드 렌더링 검증
  - Phase 6.3: API 통합 테스트 12개 + CLI/로컬 관리 스크립트 검증
  - Phase 6.4: Mock Slack/SMTP 테스트 10개

---

## 🚀 Next Steps

**검토 완료 후 진행할 작업:**

1. **Plan Approval**: 위 검토를 통과하면 계획 승인
2. **Branch Creation**: `feature/phase-6.2-grafana-monitoring` 브랜치 생성
3. **Task Kickoff**: Phase 6.2-T1 (Prometheus 메트릭 5개 추가) 시작
4. **Timeline Setup**: GitHub Project 보드에 Task 등록
5. **Documentation**: `docs/progress/v1/ISSUE_45_IMPLEMENTATION.md` 진행 추적

---

## 💡 피드백 요청

이 계획에 대해 다음 사항을 확인해주세요:

1. **우선순위**: Phase 6.2 (Grafana) → 6.3 (API) 순서가 적절한가요?
2. **범위**: Phase 6.4 (알림)와 6.1 (PostgreSQL)을 선택적으로 두는 것이 합리적인가요?
3. **시간**: 2주 (Phase 6.2+6.3) vs 6주 (전체) 중 어느 것을 목표로 할까요?
4. **추가 요구사항**: 놓친 기능이나 고려해야 할 사항이 있나요?

현재 브랜치 `issue-45`에서 작업 시작 준비가 완료되었습니다. 승인하시면 즉시 구현을 시작하겠습니다! 🚀
